echo "Running pre-commit checks..."

# Run lint-staged for linting and knip on staged files
npx lint-staged || {
  echo "Lint checks failed. Please fix the errors before committing."
  exit 1
}

# Check TypeScript build errors only if TS/TSX files are staged
if git diff --cached --name-only | grep -qE '\.(ts|tsx)$'; then
  echo "Checking for TypeScript build errors..."
  npm run build || {
    echo "Build failed. Please fix the errors before committing."
    exit 1
  }
else
  echo "No TypeScript files changed, skipping build check."
fi

echo "All pre-commit checks passed!"
